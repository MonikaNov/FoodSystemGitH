rm(list=ls())

WDuni<-c("/its/home/mn301/foodSystems/dataFS") # uni
WDhome<-c("/home/trennion/foodSystems/dataFS") # doma

setwd(WDuni)
setwd(WDhome)



#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
library(plm)
library(pglm)
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

filenames <- list.files("Main", pattern="*.RData", full.names=TRUE)
lapply(filenames,load,.GlobalEnv)
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Phase07<-pdata.frame(Phase06,index=c("CountyID","T"))

purtest(Phase07$SPEI18,q=1,
        test = c( "ips"),
        exo = ("trend"),
        lags =3, pmax = 10, Hcons = TRUE)



aa<-(11:17)
mapply(function(df=Phase07,aa,ll) 
{
 ll<-purtest(Phase07[,aa],q=1,
          test = c( "ips"),
          exo = ("trend"),
          lags =3, pmax = 10, Hcons = TRUE)
 print(names(Phase07)[aa])
 print(ll)
},2,aa)












aa<-(11:17)
mapply(function(df=Phase07,aa,ll) 
{
  ll<-purtest(Phase07[,aa],q=1,
              test = c( "ips"),
              exo = ("intercept"),
              lags =3, pmax = 10, Hcons = TRUE)
  print(names(Phase07)[aa])
  print(ll)
},2,aa)



aa<-(11:17)
mapply(function(df=Phase07,aa,ll) 
{
  ll<-purtest(Phase07[,aa],q=2,
              test = c( "ips"),
              exo = ("intercept"),
              lags =3, pmax = 10, Hcons = TRUE)

  print(names(Phase07)[aa])
  print(ll)
},2,aa)


purtest(Phase07$SPEI18,q=4,
        test = c( "ips"),
        exo = ("trend"),
        lags =3, pmax = 10, Hcons = TRUE)
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
VCIallz2<-pdata.frame(VCIallz,index=c("CountyID","T"))
purtest(VCIallz2$mean,q=2,
        test = c( "ips"),
        exo = ("trend"),
        lags =3, pmax = 5, Hcons = TRUE)
